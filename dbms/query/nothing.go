// Copyright Suneido Software Corp. All rights reserved.
// Governed by the MIT license found in the LICENSE file.

package query

import "github.com/apmckinlay/gsuneido/runtime"

// Nothing is a null query that produces no output.
// It results from a Join, Where, or Intersect with a Fixed conflict.
// It is not generated by the query parser.
type Nothing struct {
	cache
	columns []string
}

func NewNothing(columns []string) *Nothing {
	return &Nothing{columns: columns}
}

var _ Query = (*Nothing)(nil)

func (no *Nothing) String() string {
	return "NOTHING"
}

func (no *Nothing) Transform() Query {
	return no
}

func (no *Nothing) Columns() []string {
	return nil
}

func (no *Nothing) Keys() [][]string {
	return [][]string{{}}
}

func (no *Nothing) Indexes() [][]string {
	return [][]string{{}}
}

func (no *Nothing) Nrows() int {
	return 0
}

func (no *Nothing) rowSize() int {
	return 0
}

func (*Nothing) Ordering() []string {
	return nil
}

func (no *Nothing) Fixed() []Fixed {
	return nil
}

func (no *Nothing) Updateable() string {
	return "nothing"
}

func (no *Nothing) SingleTable() bool {
	return true
}

func (no *Nothing) SetTran(QueryTran) {
}

func (no *Nothing) optimize(Mode, []string) (Cost, interface{}) {
	return 0, nil
}

func (no *Nothing) setApproach(_ []string, _ interface{}, _ QueryTran) {
}

func (no *Nothing) lookupCost() Cost {
	return 0
}

func (*Nothing) Lookup([]string, []string) runtime.Row {
	return nil
}

func (no *Nothing) Header() *runtime.Header {
	return runtime.SimpleHeader(no.columns)
}

func (no *Nothing) Output(runtime.Record) {
	panic("can't Output to nil query")
}

func (*Nothing) Get(runtime.Dir) runtime.Row {
	return nil
}

func (no *Nothing) Rewind() {
}

func (no *Nothing) Select([]string, []string) {
}
